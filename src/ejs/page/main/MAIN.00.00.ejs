<!DOCTYPE html>
<html lang="ko">
<head>
<%-include('../_templates/_head.ejs', {
	layoutTemplate: 'front',
	pageStyle: 'main',
	pageJavascript: ''
}) %>
</head>
<body>
<!-- Modal -->
<div id="wrap" class="wrap">
    <!-- main -->
    <main id="main" class="page main">
        <div class="page-body">
            <section class="section key-visual">
                <div class="section-wrap">
                    <div class="section-head blind">
                        <h2 class="section-subject">ClickESG</h2>
                    </div>
                    <div class="section-body">
                        <div class="swiper-display">
                            <div class="swiper swiper-list bg">
                                <ul class="swiper-wrapper">
                                    <li class="swiper-slide swiper-item">
                                        <video class="swiper-figure" preload="auto" autoplay loop muted playsinline src="../../assets/movies/main-visual-01.mp4"></video>
                                    </li>
                                    <li class="swiper-slide swiper-item">
                                        <video class="swiper-figure" preload="auto" autoplay loop muted playsinline src="../../assets/movies/main-visual-02.mp4"></video>
                                    </li>
                                    <li class="swiper-slide swiper-item">
                                        <video class="swiper-figure" preload="auto" autoplay loop muted playsinline src="../../assets/movies/main-visual-03.mp4"></video>
                                    </li>
                                </ul>
                            </div>
                            <div class="swiper-inner">
                                <div class="swiper swiper-list title">
                                    <ul class="swiper-wrapper">
                                        <li class="swiper-slide swiper-item">
                                            <div class="swiper-wrap">
                                                <div class="swiper-head">
                                                    <h3 class="swiper-subject">ClickESG SERVICE</h3>
                                                </div>
                                                <div class="swiper-body">
                                                    <p class="para">ClickESG는 Global 표준 기술력 보유하고,<br> ESG 전문성을 가진 기업중심의 컨설팅 서비스를 제공합니다.</p>
                                                </div>
                                            </div>
                                        </li>
                                        <li class="swiper-slide swiper-item">
                                            <div class="swiper-wrap">
                                                <div class="swiper-head">
                                                    <h3 class="swiper-subject">ClickESG Solutions</h3>
                                                </div>
                                                <div class="swiper-body">
                                                    <p class="para">맞춤형 ESG 솔루션으로 고객니즈에 맞춘 최적화 솔루션을 제공하고, 다양한 언어 Pack을 갖춰 해외사업장의 공급망 ESG 진단을 지원할 수 있습니다.</p>
                                                </div>
                                            </div>
                                        </li>
                                        <li class="swiper-slide swiper-item">
                                            <div class="swiper-wrap">
                                                <div class="swiper-head">
                                                    <h3 class="swiper-subject">About ClickESG</h3>
                                                </div>
                                                <div class="swiper-body">
                                                    <p class="para">ESG 혁신의 선두주자 SK C&C ClickESG<br> 기술과 전문성으로 지속가능한 미래를 열어갑니다.</p>
                                                </div>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                                <div class="swiper swiper-list link">
                                    <ul class="swiper-wrapper">
                                        <li class="swiper-slide swiper-item">
                                            <a href="#" class="btn module-a style-a color-b">
                                                <span class="btn-text">More</span>
                                            </a>
                                        </li>
                                        <li class="swiper-slide swiper-item">
                                            <a href="#" class="btn module-a style-a color-b">
                                                <span class="btn-text">More</span>
                                            </a>
                                        </li>
                                        <li class="swiper-slide swiper-item">
                                            <a href="#" class="btn module-a style-a color-b">
                                                <span class="btn-text">More</span>
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="swiper-controls">
                                    <div class="swiper-pagination"></div>
                                    <div class="controls">
                                        <button id="toggleButton">Stop</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </main>
     <!-- // main -->
</div>
<script>
    var slideData = [
        { num: 1, name: 'ClickESG Service' },
        { num: 2, name: 'ClickESG Solutions' },
        { num: 3, name: 'About ClickESG' }
    ];

    var sliderLink = new Swiper(".link", {
        loop: true,
        allowTouchMove: false,
        autoplay: {
            delay: 5000,
        },
        effect: 'fade',
    });

    var slider = new Swiper(".bg", {
        slidesPerView: 1,
        loop: true,
        autoplay: {
            delay: 5000,
        },
        speed: 1200,
        pagination: {
            el: ".swiper-controls .swiper-pagination",
            clickable: true,
            renderBullet: function (index, className) {
                return '<div class="' + className + '"><span class="timer-title">'+ 0 + (index + 1) + ' ' + slideData[index].name +'</span>'+ '<span class="timer-bar"><span class="timer-percent"></span></span></div>';
            },
        },
        thumbs: {
            swiper: sliderLink
        },
        on: {
                slideChange: function() {
                    resetTimer();
                },
                init: function() {
                    resetTimer();
                },

            }
    });

    var sliderTitle = new Swiper(".title", {
        loop: true,
        speed: 1200,
    });

    slider.controller.control = sliderTitle;
    sliderTitle.controller.control = slider;

    // Toggle Play/Stop functionality
    var toggleButton = document.getElementById('toggleButton');
        toggleButton.addEventListener('click', function() {
            if (slider.autoplay.running) {
                slider.autoplay.stop();
                stopTimer();
                toggleButton.textContent = 'Play';
            } else {
                slider.autoplay.start();
                startTimer();
                toggleButton.textContent = 'Stop';
            }
        });

        function resetTimer() {
            var activeBulletT = $('.swiper-pagination-bullet-active .timer-title');
            var activeBullet = $('.swiper-pagination-bullet-active');
            var activeBulletPercent =$('.swiper-pagination-bullet-active .timer-percent');
            var allBullets = $('.swiper-pagination-bullet .timer-percent');
           // 모든 타이머 퍼센트를 초기화
           allBullets.each(function() {
        $(this).css('width', '0%');
        $(this).css('transition', 'none');
        //this.offsetWidth; // Trigger reflow to restart animation
    });

    // 현재 활성화된 타이머 퍼센트에 애니메이션 적용
    if (activeBulletPercent) {
        var activeBulletTW = activeBulletT.offsetWidth;
        activeBullet.style.width = activeBulletTW + 'px';
        // 비동기적으로 애니메이션 시작
        setTimeout(function() {
            activeBulletPercent.css('transition', 'width 5s linear'); // 애니메이션을 좀 더 부드럽게
            activeBulletPercent.css('width', '100%');
        }, 10); // 약간의 지연을 주어 리플로우가 완료되도록 함
    }
        }

        function stopTimer() {
            var allBullets = document.querySelectorAll('.timer-percent');
            // allBullets.forEach(function(bullet) {
            //     var computedStyle = window.getComputedStyle(bullet);
            //     bullet.style.width = computedStyle.width;
            //     bullet.style.transition = 'none';
            // });

            allBullets.each(function() {
                $(this).css('width', '0%');
                $(this).css('transition', 'none');
                //this.offsetWidth; // Trigger reflow to restart animation
            });
        }

        // function startTimer() {
        //     var activeBulletPercent = document.querySelector('.swiper-pagination-bullet-active .timer-percent');
        //     if (activeBulletPercent) {
        //         activeBulletPercent.style.transition = 'width 5s';
        //         activeBulletPercent.style.width = '100%';
        //     }
        // }

</script>
</body>
</html>